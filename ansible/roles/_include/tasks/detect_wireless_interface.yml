- name: detect wireless interface
  register: wireless_interface_autodetected
  set_fact:
    wireless_interface: "{{ item }}"
  when: item.startswith("wl")
  with_items: "{{ ansible_interfaces }}"

- name: fail if we could not detect the wireless interface
  fail:
    msg: >
      Could not detect wireless interface. Consider setting
      the variable ``wireless_interface`` explicitly.
  when: wireless_interface_autodetected is defined and not
        wireless_interface is defined

- name: warn if wireless CIDR is not set explicitly
  debug:
    msg: >
      Variable ``wireless_interface`` not set explicitly in configuration.
      Your probably want to do this.
      Using automatically detected interface "{{ wireless_interface }}"
      meanwhile.
  when: wireless_interface_autodetected is defined
